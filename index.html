<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>วงกลมวิเคราะห์ธาตุเจ้าเรือน</title>
  <style>
    body {
      background-color: #222;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    h1 {
      color: white;
    }
    .container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 20px;
      margin-top: 20px;
    }
    .form-section {
      text-align: left;
    }
    .circle-container {
      position: relative;
      width: 500px;
      height: 500px;
    }
    .circle-container img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      transform-origin: center;
      cursor: grab;
    }
    .instructions {
      margin-top: 20px;
      text-align: left;
      display: inline-block;
    }
    select, input {
      margin: 5px 0;
      padding: 5px;
    }
    button {
      padding: 6px 12px;
      margin-top: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>วงกลมวิเคราะห์ธาตุเจ้าเรือน</h1>

  <div class="container">
    <!-- ฟอร์มด้านซ้าย -->
    <div class="form-section">
      <label>วัน:</label>
      <select id="day">
        <!-- 1-31 -->
        <script>
          for(let i=1;i<=31;i++){
            document.write(`<option value="${i}">${i}</option>`);
          }
        </script>
      </select><br>

      <label>เดือน:</label>
      <select id="month">
        <option value="1">มกราคม</option>
        <option value="2">กุมภาพันธ์</option>
        <option value="3">มีนาคม</option>
        <option value="4">เมษายน</option>
        <option value="5">พฤษภาคม</option>
        <option value="6">มิถุนายน</option>
        <option value="7">กรกฎาคม</option>
        <option value="8">สิงหาคม</option>
        <option value="9">กันยายน</option>
        <option value="10">ตุลาคม</option>
        <option value="11">พฤศจิกายน</option>
        <option value="12">ธันวาคม</option>
      </select><br>

      <label>ปี (พ.ศ.):</label>
      <input type="number" id="year" placeholder="เช่น 2530"><br>
      <button onclick="calculateReference()">คำนวณวันอ้างอิง</button><br><br>

      <label>วันอ้างอิง:</label>
      <input type="text" id="referenceDay" readonly>
    </div>

    <!-- วงกลมตรงกลาง -->
    <div class="circle-container" id="circleContainer">
      <img src="1.png" id="circle1">
      <img src="2.png" id="circle2">
      <img src="3.png" id="circle3">
    </div>
  </div>

  <div class="instructions">
    <h2>วิธีใช้</h2>
    <ol>
      <li>กรอกวันเดือนปีเกิด กดคำนวณวันอ้างอิง</li>
      <li>หมุนแผ่นวงกลมล่าง ให้ลูกศรชี้ตรงกับวันอ้างอิง</li>
      <li>หมุนแผ่นวงกลมบน ให้ลูกศรด้านซ้ายมือชี้ตรงกับวันเดือนเกิดของผู้ต้องการตรวจ โดยให้ปลายลูกศรด้านซ้ายมือ (ด้านที่ไม่มีช่องแถบสี) ชี้ตรงกับวันเกิด</li>
      <li>อ่านผลที่ลูกศรด้านขวามือ (ด้านที่มีช่องแถบสี) จะแสดงถึงวันปฏิสนธิ และมีช่องว่าง มองเห็นแถบสีต่าง ๆ ซึ่งจะบอกให้ทราบถึงธาตุเจ้าเรือน</li>
    </ol>
  </div>

  <script>
    // ✅ ฟังก์ชันคำนวณวันอ้างอิง
    function calculateReference() {
      const referenceDates = {
        2454: "3 มีนาคม",
        2455: "22 มีนาคม",
        2456: "11 มีนาคม",
        2457: "1 มีนาคม",
        2458: "19 มีนาคม",
        2459: "8 มีนาคม",
        2460: "25 กุมภาพันธ์",
        2461: "17 มีนาคม",
        2462: "5 มีนาคม",
        2463: "24 มีนาคม",
        2464: "13 มีนาคม",
        2465: "2 มีนาคม",
        2466: "20 มีนาคม",
        2467: "9 มีนาคม",
        2468: "27 กุมภาพันธ์",
        2469: "18 มีนาคม",
        2470: "6 มีนาคม",
        2471: "25 มีนาคม",
        2472: "14 มีนาคม",
        2473: "4 มีนาคม",
        2474: "22 มีนาคม",
        2475: "11 มีนาคม",
        2476: "28 กุมภาพันธ์",
        2477: "20 มีนาคม",
        2478: "8 มีนาคม",
        2479: "25 กุมภาพันธ์",
        2480: "16 มีนาคม",
        2481: "5 มีนาคม",
        2482: "24 มีนาคม",
        2483: "13 มีนาคม",
        2484: "13 มีนาคม",
        2485: "2 มีนาคม",
        2486: "21 มีนาคม",
        2487: "9 มีนาคม",
        2488: "26 กุมภาพันธ์",
        2489: "18 มีนาคม",
        2490: "7 มีนาคม",
        2491: "25 มีนาคม",
        2492: "14 มีนาคม",
        2493: "3 มีนาคม",
        2494: "23 มีนาคม",
        2495: "11 มีนาคม",
        2496: "28 กุมภาพันธ์",
        2497: "19 มีนาคม",
        2498: "8 มีนาคม",
        2499: "26 กุมภาพันธ์",
        2500: "16 มีนาคม",
        2501: "5 มีนาคม",
        2502: "24 มีนาคม",
        2503: "12 มีนาคม",
        2504: "1 มีนาคม",
        2505: "21 มีนาคม",
        2506: "10 มีนาคม",
        2507: "27 กุมภาพันธ์",
        2508: "17 มีนาคม",
        2509: "6 มีนาคม",
        2510: "26 มีนาคม",
        2511: "14 มีนาคม",
        2512: "3 มีนาคม",
        2513: "22 มีนาคม",
        2514: "11 มีนาคม",
        2515: "29 มีนาคม",
        2516: "19 มีนาคม",
        2517: "8 มีนาคม",
        2518: "27 มีนาคม",
        2519: "15 มีนาคม",
        2520: "4 มีนาคม",
        2521: "24 มีนาคม",
        2522: "13 มีนาคม",
        2523: "1 มีนาคม",
        2524: "21 มีนาคม",
        2525: "10 มีนาคม",
        2526: "27 กุมภาพันธ์",
        2527: "17 กุมภาพันธ์",
        2528: "6 มีนาคม",
        2529: "25 มีนาคม",
        2530: "14 มีนาคม",
        2531: "3 มีนาคม",
        2532: "22 มีนาคม",
        2533: "11 มีนาคม",
        2534: "28 กุมภาพันธ์",
        2535: "19 มีนาคม",
        2536: "8 มีนาคม",
        2537: "27 มีนาคม",
        2538: "16 มีนาคม",
        2539: "4 มีนาคม",
        2540: "24 มีนาคม",
        2541: "13 มีนาคม",
        2542: "2 มีนาคม",
        2543: "20 มีนาคม",
        2544: "9 มีนาคม",
        2545: "1 มีนาคม",
        2546: "18 มีนาคม",
        2547: "6 มีนาคม",
        2548: "25 มีนาคม",
        2549: "14 มีนาคม",
        2550: "3 มีนาคม",
        2551: "22 มีนาคม",
        2552: "11 มีนาคม",
        2553: "28 กุมภาพันธ์",
        2554: "19 มีนาคม",
        2555: "7 มีนาคม",
        2556: "27 มีนาคม",
        2557: "16 มีนาคม",
        2558: "5 มีนาคม",
        2559: "23 มีนาคม",
        2560: "12 มีนาคม",
        2561: "2 มีนาคม",
        2562: "21 มีนาคม",
        2563: "9 มีนาคม",
        2564: "26 กุมภาพันธ์",
        2565: "18 มีนาคม",
        2566: "7 มีนาคม",
        2567: "25 มีนาคม",
        2568: "14 มีนาคม",
        2569: "3 มีนาคม",
        2570: "22 มีนาคม"
      };

      const year = parseInt(document.getElementById("year").value);
      if(referenceDates[year]) {
        document.getElementById("referenceDay").value = referenceDates[year];
      } else {
        document.getElementById("referenceDay").value = "ไม่พบข้อมูล";
      }
    }

    // ✅ ฟังก์ชันลากหมุนวงกลม
    const circles = [document.getElementById("circle2"), document.getElementById("circle3")];
    circles.forEach(circle => {
      let isDragging = false;
      let startAngle = 0;

      circle.addEventListener("mousedown", e => {
        isDragging = true;
        startAngle = Math.atan2(
          e.clientY - circle.parentElement.offsetTop - circle.parentElement.offsetHeight/2,
          e.clientX - circle.parentElement.offsetLeft - circle.parentElement.offsetWidth/2
        ) - (parseFloat(circle.dataset.angle) || 0);
      });

      window.addEventListener("mousemove", e => {
        if(!isDragging) return;
        let angle = Math.atan2(
          e.clientY - circle.parentElement.offsetTop - circle.parentElement.offsetHeight/2,
          e.clientX - circle.parentElement.offsetLeft - circle.parentElement.offsetWidth/2
        ) - startAngle;
        circle.style.transform = `rotate(${angle}rad)`;
        circle.dataset.angle = angle;
      });

      window.addEventListener("mouseup", () => isDragging = false);
    });
  </script>
</body>
</html>
